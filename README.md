# df_session_created
Метод для создания session_id на основе временных интервалов запросов пользователя.

## Описание
Метод группирует запросы пользователя к сайту на условные сессии основываясь на временном интервале.
Логика алгоритма строиться на определении момента начала сессии с точностью до пользователя. 
На вход принимается DataFrame и значение интервала (в секундах), возвращается DataFrame с дополнительным столбцом session_id (содержит уникальный id сессии). 

## Демонстрация
1. Создайте виртуальное окружение, устновите необходимые пакеты из requirements.txt.
2. Создайте файл с тестовыми данными в формате CSV, разделитель ';'. Формат данных:
```
customer_id;product_id;timestamp
customer9;product_14;2022-11-01 19:08:15.451365
customer34;product_4;2022-11-01 19:39:52.341121
```
Где:
customer_id - идентификатор пользователя
product_id - идентификатор продукта (который просматривал пользователь)
timestamp - дата и время запроса

Вы можете использовать готовые тестовые данные - см. файл data_test.csv.

3. Создайте в директории со скриптом файл settings.yaml со следующим содержанием:
```test_data_file: <наименование файла с тестовыми данными>
test_result_file: <наименование файла с результатом работы>
time_delta_session: <интервал между запросами в секундах>
required_columns: #Обязательные поля входящего DataFrame
  - customer_id
  - product_id
  - timestamp
 ```
Пример settings.yaml см. в файле - settings_example.yaml
4. Выполните из виртуального окружения:
```
python run.py
```
## FAQ
1. Функция create_session_id принимает на вход - DataFrame с данными и значение интервала (количество секунд) - int. 
2. Для использования алгоритма в своём проекте импортируйте функцию create_session_id из df_custom_method.py.
```
from df_custom_method import create_session_id
```
В качестве метода:

```
from pandas.core.base import PandasObject
from df_custom_method import create_session_id
..

my_df = my_df.create_session_id(180)
```
3. Для теста с большим набором тестовых данных (5000000 записей), можете воспользоваться - https://disk.yandex.ru/d/KEcisn8NL6272A  
4. Значение session_id уникально в рамках результирующего DataFrame.
